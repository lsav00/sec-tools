"""
objective: parse apivoid output (json format) with python
solution: import json and separate each child dictionary into a variable
POC: this script goes to the detection rate dictionary by assigning each child to its own variable and then prints the detection rate. Also added detections.
setup: use requests and apivoid key and ip to search and print to terminal. copy the JSON into x's assignment below (line 13). imported json into splunk to read the json easier 
next: instead of pasting the json, open a json file
next: combine the apivoid request and user-inputted IP <=don't have to do this if opening json file, i.e., don't have to request with python
next: print more than the detections & detections rate: Also include list of true engines 
"""

import json

# some JSON:
x =  '{"data":{"report":{"blacklists":{"engines":{"6":{"engine":"Anti-Attacks BL","detected":true,"reference":"https:\/\/www.anti-attacks.com\/","elapsed":"0.00"},"7":{"engine":"BadIPs","detected":false,"reference":"https:\/\/www.badips.com\/","elapsed":"0.00"},"8":{"engine":"Bambenek Consulting","detected":false,"reference":"http:\/\/www.bambenekconsulting.com\/","elapsed":"0.00"},"9":{"engine":"Blacklists_co","detected":false,"reference":"http:\/\/blacklists.co\/","elapsed":"0.00"},"10":{"engine":"BlockList_de","detected":false,"reference":"http:\/\/www.blocklist.de\/","elapsed":"0.00"},"11":{"engine":"Blocklist.net.ua","detected":false,"reference":"https:\/\/blocklist.net.ua\/","elapsed":"0.00"},"12":{"engine":"BloggingFusion BL","detected":false,"reference":"https:\/\/www.bloggingfusion.com\/","elapsed":"0.00"},"13":{"engine":"Booru BL","detected":false,"reference":"","elapsed":"0.00"},"14":{"engine":"Botvrij.eu","detected":false,"reference":"http:\/\/botvrij.eu\/","elapsed":"0.00"},"15":{"engine":"Brute Force Blocker","detected":false,"reference":"http:\/\/danger.rulez.sk\/index.php\/bruteforceblocker\/","elapsed":"0.00"},"16":{"engine":"Bytefarm_ch IP BL","detected":false,"reference":"https:\/\/www.bytefarm.ch\/fail2ban\/","elapsed":"0.00"},"17":{"engine":"C-APT-ure","detected":false,"reference":"http:\/\/c-apt-ure.blogspot.com\/","elapsed":"0.00"},"19":{"engine":"CERT-PA","detected":false,"reference":"https:\/\/www.cert-pa.it\/","elapsed":"0.00"},"18":{"engine":"CERT.gov.ge","detected":false,"reference":"http:\/\/www.cert.gov.ge\/","elapsed":"0.00"},"20":{"engine":"CI Army List","detected":false,"reference":"http:\/\/cinsscore.com\/#list","elapsed":"0.00"},"22":{"engine":"CSpace Hostings IP BL","detected":false,"reference":"https:\/\/cspacehostings.com\/","elapsed":"0.00"},"21":{"engine":"Charles Haley","detected":false,"reference":"http:\/\/charles.the-haleys.org\/","elapsed":"0.00"},"23":{"engine":"Cybercrime-tracker.net","detected":false,"reference":"http:\/\/cybercrime-tracker.net\/index.php","elapsed":"0.00"},"24":{"engine":"Darklist.de","detected":false,"reference":"http:\/\/www.darklist.de\/","elapsed":"0.00"},"0":{"engine":"EFnet_RBL","detected":false,"reference":"http:\/\/rbl.efnetrbl.org\/multicheck.php","elapsed":"0.00"},"25":{"engine":"Ens160 SSH BL","detected":false,"reference":"https:\/\/ens160.com\/blacklist","elapsed":"0.00"},"26":{"engine":"Etnetera BL","detected":false,"reference":"https:\/\/security.etnetera.cz\/","elapsed":"0.00"},"27":{"engine":"FSpamList","detected":false,"reference":"https:\/\/fspamlist.com\/","elapsed":"0.00"},"28":{"engine":"GPF DNS Block List","detected":false,"reference":"https:\/\/www.gpf-comics.com\/dnsbl\/export.php","elapsed":"0.00"},"29":{"engine":"GreenSnow Blocklist","detected":false,"reference":"https:\/\/greensnow.co\/","elapsed":"0.00"},"31":{"engine":"IPSpamList","detected":false,"reference":"http:\/\/www.ipspamlist.com\/ip-lookup\/","elapsed":"0.00"},"32":{"engine":"IPsum","detected":true,"reference":"https:\/\/github.com\/stamparm\/ipsum","elapsed":"0.00"},"30":{"engine":"InterServer IP List","detected":true,"reference":"https:\/\/sigs.interserver.net\/","elapsed":"0.00"},"33":{"engine":"LAPPS Grid Blacklist","detected":true,"reference":"http:\/\/www.lappsgrid.org\/","elapsed":"0.00"},"34":{"engine":"LashBack UBL","detected":false,"reference":"http:\/\/blacklist.lashback.com\/","elapsed":"0.00"},"35":{"engine":"Liquid Binary","detected":true,"reference":"https:\/\/liquidbinary.com\/","elapsed":"0.00"},"36":{"engine":"Log.Onoh.Info","detected":false,"reference":"http:\/\/log.onoh.info\/","elapsed":"0.00"},"40":{"engine":"MKXT_NET SSH BL","detected":false,"reference":"https:\/\/mkxt.net\/","elapsed":"0.00"},"37":{"engine":"Malc0de","detected":false,"reference":"http:\/\/malc0de.com\/database\/index.php","elapsed":"0.00"},"38":{"engine":"MalwareDomainList","detected":false,"reference":"http:\/\/www.malwaredomainlist.com\/","elapsed":"0.00"},"39":{"engine":"Matapala_org FW Log","detected":false,"reference":"https:\/\/log.matapala.org\/","elapsed":"0.00"},"1":{"engine":"MegaRBL","detected":true,"reference":"https:\/\/www.megarbl.net\/check","elapsed":"0.00"},"41":{"engine":"Migniot SSH Bullies","detected":false,"reference":"https:\/\/www.migniot.com\/","elapsed":"0.00"},"42":{"engine":"Ms-ds-violation-ips","detected":false,"reference":"https:\/\/github.com\/conmarap\/ms-ds-violation-ips","elapsed":"0.00"},"43":{"engine":"NEU SSH Black list","detected":false,"reference":"http:\/\/antivirus.neu.edu.cn\/scan\/","elapsed":"0.00"},"44":{"engine":"NoIntegrity BL","detected":false,"reference":"http:\/\/www.nointegrity.org\/","elapsed":"0.00"},"45":{"engine":"NoThink.org","detected":false,"reference":"http:\/\/www.nothink.org\/","elapsed":"0.00"},"2":{"engine":"NordSpam","detected":false,"reference":"https:\/\/www.nordspam.com\/","elapsed":"0.00"},"46":{"engine":"Olegon Blocked IPs","detected":false,"reference":"https:\/\/olegon.ru\/","elapsed":"0.00"},"47":{"engine":"Organized Villainy Seattle Honeypot","detected":false,"reference":"https:\/\/organizedvillainy.com\/","elapsed":"0.00"},"3":{"engine":"PSBL","detected":false,"reference":"http:\/\/psbl.org\/","elapsed":"0.00"},"48":{"engine":"Peter-s NUUG IP BL","detected":false,"reference":"https:\/\/home.nuug.no\/~peter\/","elapsed":"0.00"},"49":{"engine":"PhishTank","detected":false,"reference":"http:\/\/www.phishtank.com\/","elapsed":"0.00"},"50":{"engine":"PlonkatronixBL","detected":false,"reference":"http:\/\/bl.plonkatronix.com\/","elapsed":"0.00"},"51":{"engine":"Ransomware Tracker","detected":false,"reference":"https:\/\/ransomwaretracker.abuse.ch\/","elapsed":"0.00"},"52":{"engine":"Redstout Threat IP list","detected":true,"reference":"https:\/\/www.redstout.com\/index.html","elapsed":"0.00"},"53":{"engine":"Reuteras Scanning Lists","detected":false,"reference":"https:\/\/attackers.ongoing.today\/","elapsed":"0.00"},"54":{"engine":"Ring-u NOC","detected":false,"reference":"https:\/\/portal.ring-u.com\/portal\/portal.php","elapsed":"0.00"},"55":{"engine":"Roquesor BL","detected":false,"reference":"https:\/\/es.roquesor.com\/en\/","elapsed":"0.00"},"56":{"engine":"Rutgers Drop List","detected":true,"reference":"http:\/\/www.rutgers.edu\/","elapsed":"0.00"},"57":{"engine":"S.S.S.H.I.A","detected":false,"reference":"https:\/\/github.com\/mitchellkrogza\/Suspicious.Snooping.Sniffing.Hacking.IP.Addresses\/","elapsed":"0.00"},"4":{"engine":"S5hbl","detected":true,"reference":"http:\/\/www.usenix.org.uk\/content\/rbl.html","elapsed":"0.09"},"59":{"engine":"SSL Blacklist","detected":false,"reference":"https:\/\/sslbl.abuse.ch\/","elapsed":"0.00"},"60":{"engine":"Sblam","detected":false,"reference":"http:\/\/sblam.com\/","elapsed":"0.00"},"58":{"engine":"Shinmura BL","detected":false,"reference":"http:\/\/www.shinmura.jp\/","elapsed":"0.00"},"5":{"engine":"Spamhaus","detected":true,"reference":"https:\/\/www.spamhaus.org\/lookup\/","elapsed":"0.07"},"61":{"engine":"St Dominics Priory College Droplist","detected":false,"reference":"https:\/\/threatintel.stdominics.sa.edu.au\/","elapsed":"0.00"},"62":{"engine":"Threat Crowd","detected":false,"reference":"https:\/\/www.threatcrowd.org\/","elapsed":"0.00"},"63":{"engine":"Threat Sourcing","detected":true,"reference":"https:\/\/www.threatsourcing.com\/","elapsed":"0.00"},"64":{"engine":"URLVir","detected":false,"reference":"http:\/\/www.urlvir.com\/","elapsed":"0.00"},"65":{"engine":"USTC IP BL","detected":false,"reference":"http:\/\/blackip.ustc.edu.cn\/","elapsed":"0.00"},"66":{"engine":"VXVault","detected":false,"reference":"http:\/\/vxvault.net\/ViriList.php","elapsed":"0.00"},"67":{"engine":"Xtream Codes BL","detected":false,"reference":"https:\/\/xtream-codes.com\/","elapsed":"0.00"},"68":{"engine":"Yeuxdelibad BL","detected":true,"reference":"https:\/\/yeuxdelibad.net\/","elapsed":"0.00"},"69":{"engine":"ZeuS Tracker","detected":false,"reference":"https:\/\/zeustracker.abuse.ch\/","elapsed":"0.00"}},"detections":12,"engines_count":70,"detection_rate":"17%","scantime":"0.17"},"information":{"reverse_dns":"antispam.tulio.com.br","continent_code":"SA","continent_name":"South America","country_code":"BR","country_name":"Brazil","region_name":"Distrito Federal","city_name":"Brasilia","latitude":-15.779720306396484,"longitude":-47.92972183227539,"isp":"Brasil Telecom S.A."},"anonymity":{"is_proxy":false,"is_webproxy":false,"is_vpn":false,"is_hosting":false,"is_tor":false}}},"credits_remained":24.76,"credits_expiration":"Tue, 21 May 2019 07:54:38 GMT","estimated_queries":"309","elapsed_time":"0.27","success":true}'

# parse x:
y = json.loads(x)
z=y['data']
a=z['report']
b=a['blacklists']
c=b['detection_rate']
d=b['detections']
print("Detection Rate:", c)
print("Detections:", d)
input("STOP")
